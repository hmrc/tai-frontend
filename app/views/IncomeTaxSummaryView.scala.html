@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.tai.viewModels.TaxAccountSummaryViewModel
@import uk.gov.hmrc.tai.viewModels.TaxCodeViewModel
@import uk.gov.hmrc.play.views.html.helpers._
@import includes.ptaHeader
@import uk.gov.hmrc.tai.config.ApplicationConfig
@import uk.gov.hmrc.tai.viewModels.IFormInProgressBannerViewModel
@import includes.link

@import controllers.auth.AuthenticatedRequest

@this(main: MainTemplate)

@(viewModel: TaxAccountSummaryViewModel, taxCodeViewModel: Map[String, TaxCodeViewModel], appConfig: ApplicationConfig
)(implicit request: AuthenticatedRequest[_],
  messages: Messages,
  templateRenderer: uk.gov.hmrc.renderer.TemplateRenderer,
  ec: scala.concurrent.ExecutionContext)


@header = @{
    ptaHeader(
        mainHeadingText = viewModel.header,
        preHeadingText = request.fullName,
        preHeadingAccessibleAnnouncement = "This section is the income tax summary for",
        showGdsVersion = true)
}

    @main(
        title = viewModel.title,
        authedUser = Some(request.taiUser),
        pageTitle = Some(Messages("tai.service.navTitle")),
        backLinkUrl = Some(routes.WhatDoYouWantToDoController.whatDoYouWantToDoPage.url),
        backLinkContent = Some(Messages("your.paye.income.tax.overview")),
        pagePrintable = true,
        pagePrintName = Some("historic-pay-as-you-earn")
    ){


    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            @header
            @includes.iFormInProgressBanner(IFormInProgressBannerViewModel(viewModel.isAnyFormInProgress), appConfig)
        </div>

    </div>




    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">



        <div class="inner-block">
            @if(viewModel.displayIyaBanner){
            <p id="inYearAdjustmentBanner" class="govuk-body panel-indent panel-indent--info flush--top">
                <span class="display-block">@Messages("tai.notifications.iya.banner.text")</span>
                @link(
                    url=routes.PotentialUnderpaymentController.potentialUnderpaymentPage.url,
                    copy=Messages("tai.notifications.iya.linkText")
                )
            </p>
            }

            @if(viewModel.employments.nonEmpty){
            <div id="incomeFromEmploymentSection" class="section flush--bottom">

                <h2 id="incomeFromEmploymentHeading" class="govuk-heading-m under-line">@Messages("tai.incomeTaxSummary.employment.section.heading")</h2>

                @incomeTaxSummaryIncomeSourceDetail(viewModel.employments, "employment", Messages("tai.incomeTaxSummary.incomeAmount.prefix"), taxCodeViewModel)

            </div>
            }

            @if(viewModel.pensions.nonEmpty){
            <div id="incomeFromPensionSection" class="govuk-!-margin-top-8 section flush--bottom">

                <h2 id="incomeFromPensionHeading" class="govuk-heading-m heading-section">@Messages("tai.incomeTaxSummary.pension.section.heading")</h2>

                @incomeTaxSummaryIncomeSourceDetail(viewModel.pensions, "pension", Messages("tai.incomeTaxSummary.incomeAmount.prefix"), taxCodeViewModel)

            </div>
            }

            @if(viewModel.otherIncomeSources.nonEmpty){
            <div id="otherIncomeSources" class="govuk-!-margin-top-8 section flush--bottom">

                <h2 id="otherIncomeSourcesHeading" class="govuk-heading-m heading-section">@Messages("tai.incomeTaxSummary.otherIncomeSources.heading")</h2>

                @incomeTaxSummaryIncomeSourceDetail(viewModel.otherIncomeSources, "otherIncomeSources", Messages("tai.incomeTaxSummary.incomeAmount.prefix"), taxCodeViewModel)

            </div>
            }

            @if(viewModel.ceasedEmployments.nonEmpty){
            <div id="endedIncomeSection" class="section">

                <h2 id="endedIncomeHeading" class="govuk-heading-m heading-section">@Messages("tai.incomeTaxSummary.ceased.section.heading", viewModel.lastTaxYearEnd)</h2>

                @if(viewModel.rtiAvailable) {
                    @incomeTaxSummaryIncomeSourceDetail(viewModel.ceasedEmployments, "income", Messages("tai.incomeTaxSummary.ceasedIncomeAmount.prefix"), taxCodeViewModel)
                } else {
                    <p class="govuk-body panel-indent panel-indent--info flush--top">@messages("tai.rti.down.ceasedEmployments")</p>
                }

            </div>
            }

            @* start of annual amounts print only*@

            <div class="section flush--bottom only-visible-on-print">
                <h2 class="govuk-heading-m under-line">@Messages("tai.incomeTaxSummary.annualAmounts.section.heading")</h2>
                <div aria-hidden="true">
                    <p class="govuk-body flush--top">
                        @link(
                        id=Some("totalEstimatedIncomeLinkPrint"),
                        url=routes.EstimatedIncomeTaxController.estimatedIncomeTax.url,
                        copy=Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxLink")
                        )
                    </p>
                </div>

                <h3 class="govuk-heading-s" >@Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreeHeading")</h3>
                <p class=" govuk-body flush--bottom">@Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreePara")</p>
                <p class="govuk-body govuk-!-font-size-36 govuk-!-font-weight-bold faded-text-dark">
                    <span class="display-block heading-36 faded-text-dark section--narrow flush">@viewModel.taxFreeAmount</span>
                </p>
                <p class=" govuk-body flush--top">
                    @link(
                    id=None,
                    url=routes.TaxFreeAmountController.taxFreeAmount.toString,
                    copy=Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreeLink")
                    )
                </p>
                <h3 class="govuk-heading-s">@Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxHeading")</h3>
                <p class="govuk-body flush--bottom">@Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxPara")</p>
                <p class="govuk-body govuk-!-font-size-36 govuk-!-font-weight-bold faded-text-dark">
                    <span class="display-block heading-36 faded-text-dark section--narrow flush">@viewModel.estimatedIncomeTaxAmount</span>
                </p>
                <p class="govuk-body flush--top">
                    @link(
                    id=None,
                    url=routes.EstimatedIncomeTaxController.estimatedIncomeTax.toString,
                    copy=Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxLink")
                    )
                </p>
            </div>


            @* end of annual amounts print only*@

            <div class="govuk-!-margin-bottom-9 govuk-!-margin-top-9">
            <div class="print-this ">
                <a class="print-this__link" href="javascript:window.print()">@Messages("tai.label.print")</a>
            </div>
            </div>

        </div>

    </div>

        <div class="govuk-grid-column-one-third hide-for-print">
        <div class="inner-block section__box--shaded">

            <div id="annualAmountsSummarySection" class="section section__box--shaded flush--bottom">

                <h2 id="annualAmountsSummaryHeading" class="govuk-heading-m under-line">@Messages("tai.incomeTaxSummary.annualAmounts.section.heading")</h2>

                <div id="incomeTaxSummaryTotalEstimatedIncome" aria-hidden="true">

                <h3 class="govuk-heading-s">@Messages("tai.incomeTaxSummary.annualAmounts.section.totalIncomeHeading")</h3>
                <p class="govuk-body flush--bottom">@Messages("tai.incomeTaxSummary.annualAmounts.section.totalIncomePara")</p>
                <p class="govuk-body flush">
                    <span class="govuk-visually-hidden">@Messages("tai.incomeTaxSummary.generalAmount.prefix") </span>
                    <span class="display-block heading-36 faded-text-dark section--narrow flush">@viewModel.totalEstimatedIncome</span>
                </p>

                <p class="govuk-body flush--top">
                    @link(
                        id=Some("totalEstimatedIncomeLink"),
                        url=routes.EstimatedIncomeTaxController.estimatedIncomeTax.url,
                        copy=Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxLink")
                    )
                </p>

                </div>


                <h3 class="govuk-heading-s" >@Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreeHeading")</h3>
                <p class=" govuk-body flush--bottom">@Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreePara")</p>
                <p class="govuk-body govuk-!-font-size-36 govuk-!-font-weight-bold faded-text-dark">
                    <span class="govuk-visually-hidden">@Messages("tai.incomeTaxSummary.generalAmount.prefix") </span>
                    <span class="display-block heading-36 faded-text-dark section--narrow flush">@viewModel.taxFreeAmount</span>
                </p>
                <p class=" govuk-body flush--top">
                    @link(
                        id=Some("taxFreeAmountLink"),
                        url=routes.TaxFreeAmountController.taxFreeAmount.toString,
                        copy=Messages("tai.incomeTaxSummary.annualAmounts.section.taxFreeLink")
                    )
                </p>
                <h3 class="govuk-heading-s">@Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxHeading")</h3>
                <p class="govuk-body flush--bottom">@Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxPara")</p>
                <p class="govuk-body govuk-!-font-size-36 govuk-!-font-weight-bold faded-text-dark">
                    <span class="govuk-visually-hidden">@Messages("tai.incomeTaxSummary.generalAmount.prefix") </span>
                    <span class="display-block heading-36 faded-text-dark section--narrow flush">@viewModel.estimatedIncomeTaxAmount</span>
                </p>
                <p class="govuk-body flush--top">
                    @link(
                        id=Some("estimatedIncomeTaxLink"),
                        url=routes.EstimatedIncomeTaxController.estimatedIncomeTax.toString,
                        copy=Messages("tai.incomeTaxSummary.annualAmounts.section.incomeTaxLink")
                    )
                </p>
            </div>

            <div id="addMissingIncomeSourceSection" class="section section__box--shaded">

                <h2 id="addMissingIncomeSourceHeading"  class="govuk-heading-m under-line">@Messages("tai.incomeTaxSummary.addMissingIncome.section.heading")</h2>

                <ul class="govuk-list">
                    <li>
                        <p class="icon icon-plus-no-rpt">
                            @link(
                                id=Some("addEmploymentLink"),
                                url=controllers.employments.routes.AddEmploymentController.addEmploymentName.toString,
                                copy=Messages("tai.incomeTaxSummary.addMissingIncome.section.employerLink")
                            )
                        </p>
                    </li>
                    <li>
                        <p class="icon icon-plus-no-rpt">
                            @link(
                                id=Some("addPensionLink"),
                                url=controllers.pensions.routes.AddPensionProviderController.addPensionProviderName.toString,
                                copy=Messages("add.missing.pension")
                            )
                        </p>
                    </li>
                    <li>
                        <p class="icon icon-plus-no-rpt">
                        @link(
                            id=Some("addInvestmentLink"),
                            url=appConfig.investmentIncomeLinkUrl,
                            copy=Messages("tai.incomeTaxSummary.addMissingIncome.section.investmentIncomeLink")
                            )
                        </p>
                    </li>
                    <li>
                        <p class="icon icon-plus-no-rpt">
                            @link(
                                id=Some("addOtherIncomeSourceLink"),
                                url=appConfig.otherIncomeLinkUrl,
                                copy=Messages("tai.incomeTaxSummary.addMissingIncome.section.otherLink")
                            )
                        </p>
                    </li>
                </ul>

            </div>
        </div>
    </div>
</div>
}
